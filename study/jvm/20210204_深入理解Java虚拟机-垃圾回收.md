# 深入理解Java虚拟机-垃圾回收

## 概述

**垃圾回收（Garbage Collection，简称GC）**诞生于麻省理工学院的Lisp语言，主要涉及内存动态分配及内存回收技术。

JVM内存结构包括程序计数器、虚拟机栈、本地方法栈、堆、方法区五个部分，其中程序计数器、虚拟机栈、本地方法栈是线程私有的，故不需要考虑垃圾回收问题，而堆和方法区的分配和回收是动态的，故需要进行垃圾回收。

## 如何判断对象是否可以被回收

### 引用计数法

引用计数法（Reference Counting）是指在对象中添加一个引用计数器，每当有一个地方引用它时，计数器的值就会+1，任何时刻计数器为0时对象就是不可能再被使用。

优点：原理简单，判断效率高。

缺点：引用计数无法解决循环依赖问题。

![6_引用计数法](D:\study_note\maningning1.github.io\images\jvm\6_引用计数法.png)

故Java虚拟机没有使用引用计数法来管理内存。

### 可达性分析

因为引用计数法存在的问题，Java虚拟机等主流的商用程序语言都是通过可达性分析（Reachability Analysis）算法来判断对象是否存活。这个算法的思想是通过一个根对象作为起点，根据引用关系向下搜索，如下图所示，对象object5、object6、object7虽然互有关联，但是他们的根不可达，故会被判定为可回收对象。

![1.7_可达性分析](D:\study_note\maningning1.github.io\images\jvm\1.7_可达性分析.png)

## 垃圾回收算法

## 分代垃圾回收

## 垃圾回收器

## 调优